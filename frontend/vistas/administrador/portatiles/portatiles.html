<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <title>Materiales (Carros de Portátiles) - IES Bajo Aragón</title>
    
    <!-- SOLO Bootstrap Icons (NO EL CSS COMPLETO) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    
    <script>const BASE = window.location.origin + "/frontend";</script>

    <script>
        const script1 = document.createElement("script");
        script1.src = BASE + "/javascript/includes.js";
        script1.onload = () => {
            const script2 = document.createElement("script");
            script2.src = BASE + "/javascript/menu.js";
            script2.onload = () => {
                generarPagina("admin", "admin");
            };
            document.head.appendChild(script2);
        };
        document.head.appendChild(script1);
    </script>
    
    <!-- Estilos adicionales por si acaso -->
    <style>
        .bg-azul {
            background-color: #0d6efd;
        }
        .bg-blue {
            background-color: #0d6efd;
        }
        /* Asegurar que los modales se vean correctamente */
        .modal-backdrop {
            z-index: 1040 !important;
        }
        .modal {
            z-index: 1050 !important;
        }
    </style>
</head>

<body>

<div id="header"></div>

<main class="container mt-5">
    <!-- CABECERA -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Materiales (Carros de Portátiles)</h2>
        <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#modalCrear">
            <i class="bi bi-plus-circle"></i> Crear carro
        </button>
    </div>

    <!-- CONTENEDOR DE TARJETAS -->
    <div id="portatilesContainer" class="row g-4">
        <div class="col-12 text-center py-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Cargando...</span>
            </div>
            <p class="mt-2">Cargando materiales...</p>
        </div>
    </div>

    <!-- VOLVER -->
    <div class="divvolver container p-0 pb-3 mb-5 mt-0 text-end fs-5">
        <a href="../menuadministrador.html" class="bg-azul rounded-pill p-2 px-3 text-light">
            <i class="bi bi-caret-left-fill"></i> Volver
        </a>
    </div>

</main>

<!-- MODAL CREAR -->
<div class="modal fade" id="modalCrear" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="bi bi-plus-circle me-2"></i>
                    Crear carro de portátiles
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="formCrearPortatil">
                    <div class="mb-3">
                        <label class="form-label">ID del carro</label>
                        <input type="text" class="form-control" id="crearId" name="crearId" placeholder="Ej: P4" required>
                        <small class="text-muted">Identificador único (ej: P1, P2, P3...)</small>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Nombre del carro</label>
                        <input type="text" class="form-control" id="crearCarro" name="crearCarro" placeholder="Ej: Carro 4" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Edificio</label>
                        <select class="form-select" id="crearEdificio" name="crearEdificio" required>
                            <option value="">Seleccionar edificio</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Planta</label>
                        <select class="form-select" id="crearPlanta" name="crearPlanta" required>
                            <option value="">Seleccionar planta</option>
                            <option value="Planta baja">Planta baja</option>
                            <option value="Primera planta">Primera planta</option>
                            <option value="Segunda planta">Segunda planta</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Número de portátiles</label>
                        <input type="number" class="form-control" id="crearUnidades" name="crearUnidades" min="1" max="100" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="submit" form="formCrearPortatil" class="btn btn-success">
                    <i class="bi bi-check-lg me-1"></i> Crear carro
                </button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="bi bi-x-lg me-1"></i> Cancelar
                </button>
            </div>
        </div>
    </div>
</div>

<!-- MODAL EDITAR -->
<div class="modal fade" id="modalEditar" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="bi bi-pencil-square me-2"></i>
                    Editar carro de portátiles
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="formEditarPortatil">
                    <input type="hidden" id="editId" name="editId">
                    <input type="hidden" id="editIdEdificio" name="editIdEdificio">
                    <input type="hidden" id="editNumeroPlanta" name="editNumeroPlanta">
                    
                    <div class="mb-3">
                        <label class="form-label">Nombre del carro</label>
                        <input type="text" class="form-control" id="editCarro" name="editCarro" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Edificio</label>
                        <input type="text" class="form-control" id="editEdificio" name="editEdificio" readonly disabled>
                        <small class="text-muted">El edificio no se puede modificar</small>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Planta</label>
                        <input type="text" class="form-control" id="editPlanta" name="editPlanta" readonly disabled>
                        <small class="text-muted">La planta no se puede modificar</small>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Número de portátiles</label>
                        <input type="number" class="form-control" id="editUnidades" name="editUnidades" min="1" max="100" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Estado</label>
                        <select class="form-select" id="editEstado" name="editEstado" required>
                            <option value="1">Activo</option>
                            <option value="0">Inactivo</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="submit" form="formEditarPortatil" class="btn btn-primary">
                    <i class="bi bi-check-lg me-1"></i> Actualizar carro
                </button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="bi bi-x-lg me-1"></i> Cancelar
                </button>
            </div>
        </div>
    </div>
</div>

<!-- MODAL ELIMINAR (CONFIRMACIÓN) -->
<div class="modal fade" id="modalEliminar" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title">
                    <i class="bi bi-exclamation-triangle-fill me-2"></i>
                    Confirmar eliminación
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="formEliminarPortatil">
                    <input type="hidden" id="deleteId" name="deleteId">
                    
                    <p class="fs-5 mb-3">¿Estás seguro de que quieres eliminar este carro?</p>
                    <div class="alert alert-warning">
                        <i class="bi bi-info-circle-fill me-2"></i>
                        Esta acción no se puede deshacer.
                    </div>
                    <div class="bg-light p-3 rounded">
                        <p class="mb-1"><strong>Carro:</strong> <span class="fw-normal" id="deleteCarro"></span></p>
                        <p class="mb-1"><strong>Edificio:</strong> <span class="fw-normal" id="deleteEdificio"></span></p>
                        <p class="mb-1"><strong>Planta:</strong> <span class="fw-normal" id="deletePlanta"></span></p>
                        <p class="mb-0"><strong>Unidades:</strong> <span class="fw-normal" id="deleteUnidades"></span></p>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="bi bi-x-lg me-1"></i> Cancelar
                </button>
                <button type="submit" form="formEliminarPortatil" class="btn btn-danger">
                    <i class="bi bi-trash me-1"></i> Eliminar
                </button>
            </div>
        </div>
    </div>
</div>

<!-- MODAL MOSTRAR -->
<div class="modal fade" id="modalMostrar" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-info text-white">
                <h5 class="modal-title">
                    <i class="bi bi-info-circle-fill me-2"></i>
                    Detalles del carro
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p class="fw-bold">Carro: <span class="fw-light" id="mostrarCarro"></span></p>
                <p class="fw-bold">Edificio: <span class="fw-light" id="mostrarEdificio"></span></p>
                <p class="fw-bold">Planta: <span class="fw-light" id="mostrarPlanta"></span></p>
                <p class="fw-bold">Unidades: <span class="fw-light" id="mostrarUnidades"></span></p>
                <p class="fw-bold">Estado: <span class="fw-light" id="mostrarEstado"></span></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="bi bi-x-lg me-1"></i> Cerrar
                </button>
            </div>
        </div>
    </div>
</div>

<footer id="footer"></footer>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- Cargar el script de materiales -->
<script src="../../../javascript/portatiles/portatiles.js"></script>

</body>
</html>